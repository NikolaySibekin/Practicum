# Обучение с учителем
## Цели проекта
 - Проанализировать исторические данные о поведении клиентов банка и расторжении договоров. Спрогнозировать уход клиента из банка.
 - Построить модель классификации, метрика качества f1 (минимальное допустимое значение 0.59)
 - Измерить AUC-ROC, сравнить её значение с f1-мерой.
## Задачи проекта
 - Предобработка данных
 - Исследование задачи и построение классификационной модели
   - Решающее дерево
   - Случайный лес
   - Логистическая регрессия
- Устранение дисбаланса классов
  - Взвешивание классов
  - upsampling и downsampling
- Тестирование модели, расчёт метрик f1 и ROC_AUC
## Вывод по результатам исследования

В первоначальные данных наблюдался значительный дисбаланс (80% ответов целевого признака были негативными и только 20% позитивными). По этой причине обученные на этих данных модели не проходили проверку на адекватность. А также характеризовались высокой степенью ошибок и низким качеством взвешенной величины (F1-мера) и показывали низкие результаты точности и полноты.

Для устранения дисбаланс классов в обучающей выборки было перепробовано три метода:
- взвешивание классов,
- увеличение количества значений позитивного класса в 4 раза методом upsampling,
- уменьшение количества значений негативного класса в 4 раза методом downsample.

На новых данных все модели показали результат выше, чем на несбалансированной выборке. Но лучшие показатели были у модели Случайного леса (метод взвешивания классов):
- Качество: 0.84
- Полнота: 0.77
- Точность: 0.59
- F1-мера: 0.64
- AUC-ROC: 0.87

Финальные гиперпараметры выбранной модели Случайного леса (RandomForestClassifier) следующие:
- random_state=12345
- class_weight='balanced'
- max_depth=9
- max_features='auto'
- n_estimators=10

Результаты модели на тестовой выборке:
- Качество: 0.82
- Полнота: 0.64
- Точность: 0.55
- F1-мера: 0.6
- AUC-ROC: 0.84

В сравнении с контантной моделью финальная модель прошла проверку на адекватность:
- accuracy_score (качество) константой модели: 0.80
- accuracy_score (качество) финальной модели: 0.82
- AUC-ROC константой модели: 0.59
- AUC-ROC финальной модели: 0.84

## Используемый стек инструментов
- python
- pandas
- sklearn
- matplotlib
